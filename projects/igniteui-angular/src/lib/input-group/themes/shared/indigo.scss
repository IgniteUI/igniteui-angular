@use 'igniteui-theming/sass/typography' as *;
@use 'igniteui-theming/sass/color' as *;
@use 'igniteui-theming/sass/bem' as *;
@use 'styles/themes/standalone' as *;
@use 'igniteui-theming/sass/animations/easings' as *;
@use '../light/tokens' as *;

$_theme: $indigo;

@include themed-block(igx-input-group, indigo) {
    --_prefix-suffix-spacing: #{pad-inline(rem(2px), rem(4px), rem(6px))};
    --_bundle-template-rows: revert;

    igx-prefix:first-child,
    [igxPrefix]:first-child {
        border-start-start-radius: var-get($_theme, 'box-border-radius');
    }

    igx-suffix:last-child,
    [igxSuffix]:last-child {
        border-start-end-radius: var-get($_theme, 'box-border-radius');
    }

    igx-icon {
        --size: #{sizable(rem(14px), rem(16px), rem(16px))};
    }

    row-gap: rem(4px);

    &:hover {
        @include e(toggle-button) {
            color: var(--toggle-button-foreground-focus);
            background: var(--toggle-button-background-focus);
        }

        @include e(clear-button) {
            color: var(--clear-button-foreground-focus);
            background: var(--clear-button-background-focus);
        }
    }

    @include e(clear-icon) {
        &:focus {
            color: contrast-color($color: 'primary', $variant: 600);
            background: color($color: 'primary', $variant: 500);
        }
    }

    @include e(label) {
        line-height: var(--ig-caption-line-height);
    }

    @include e(input) {
        @include type-style(body-2);

        caret-color: var-get($_theme, 'focused-bottom-line-color');
        padding-inline: pad-inline(rem(2px), rem(4px), rem(6px));
        padding-block: rem(6px);

        &::placeholder {
            font-style: italic;
        }
    }

    @include m(search) {
        --_prefix-suffix-spacing: #{pad-inline(rem(6px), rem(8px), rem(10px))};

        @include e(bundle) {
            border-end-start-radius: 0;
            border-end-end-radius: 0;
        }

        @include e(input) {
            padding-inline: var(--_prefix-suffix-spacing);
        }
    }

    @include m(suffixed) {
        @include e(input) {
            padding-inline-end: 0;
        }
    }

    @include m(prefixed) {
        @include e(input) {
            padding-inline-start: 0;
        }
    }

    @include e(textarea) {
        @include type-style(body-2);

        caret-color: var-get($_theme, 'focused-bottom-line-color');

        &::placeholder {
            font-style: italic;
        }
    }

    @include e(file-input) {
        @include type-style(body-2);
    }

    @include m(textarea-group) {
        @include e(textarea) {
            padding-block: pad-block(rem(4px), rem(6px), rem(8px)) 0;
        }

        @include e(bundle) {
            height: auto;
        }
    }

    @include m(textarea-group, $not: (prefixed)) {
        @include e(textarea) {
            padding-inline-start: pad-inline(rem(2px), rem(4px), rem(6px));
        }
    }

    @include m(textarea-group, $not: (suffixed)) {
        @include e(textarea) {
            padding-inline-end: pad-inline(rem(2px), rem(4px), rem(6px));
        }
    }

    @include e(bundle) {
        transition: all .25s $out-cubic;
        border-block-end: rem(1px) solid var-get($_theme, 'idle-bottom-line-color');
        border-start-start-radius: var-get($_theme, 'box-border-radius');
        border-start-end-radius: var-get($_theme, 'box-border-radius');

        &:hover {
            background: var-get($_theme, 'box-background-hover');
            border-block-end-color: var-get($_theme, 'hover-bottom-line-color');

            .igx-input-group__toggle-button {
                color: var(--toggle-button-foreground-focus);
            }
        }
    }

    @include m(file) {
        @include e(input) {
            padding-block: 0;
        }

        @include e(bundle) {
            > * {
                grid-row: 1;
            }
        }
    }

    @include m(readonly, $not: (file, disabled)) {
        @include e(bundle) {
            border-block-end-color: var-get($_theme, 'disabled-text-color');

            &:hover:not(:focus-within) {
                background: unset;
                border-block-end-color: var-get($_theme, 'disabled-text-color');
            }
        }
    }

    @include mx(readonly, focused, ('not': (file, disabled))) {
        @include e(bundle) {
            border-block-end-color: var-get($_theme, 'focused-bottom-line-color');
        }
    }

    @include m(focused) {
        @include e(bundle) {
            background: var-get($_theme, 'box-background-focus');
            border-block-end-color: var-get($_theme, 'focused-bottom-line-color');
        }

        @include e(label) {
            color: var-get($_theme, 'focused-secondary-color');
        }
    }

    @include m(valid) {
        @include e(bundle) {
            border-block-end: rem(1px) solid var-get($_theme, 'success-secondary-color');

            &:hover {
                border-block-end-color: var-get($_theme, 'success-secondary-color');
            }
        }
    }

    @include m(warning) {
        @include e(bundle) {
            border-block-end: rem(1px) solid var-get($_theme, 'warning-secondary-color');

            &:hover {
                border-block-end-color: var-get($_theme, 'warning-secondary-color');
            }
        }
    }

    @include m(invalid) {
        @include e(bundle) {
            border-block-end: rem(1px) solid var-get($_theme, 'error-secondary-color');

            &:hover {
                border-block-end-color: var-get($_theme, 'error-secondary-color');
            }
        }
    }

    @include mx(valid, focused) {
        @include e(bundle) {
            border-block-end: rem(1px) solid var-get($_theme, 'success-secondary-color');
        }
    }

    @include mx(warning, focused) {
        @include e(bundle) {
            border-block-end: rem(1px) solid var-get($_theme, 'warning-secondary-color');
        }
    }

    @include mx(invalid, focused) {
        @include e(bundle) {
            border-block-end: rem(1px) solid var-get($_theme, 'error-secondary-color');
        }
    }

    @include e(case-icon) {
        igx-icon {
            --size: #{rem(16px)};
        }
    }

    @include m(disabled) {
        @include e(bundle) {
            background: unset;
            border-block-end: rem(1px) solid var-get($_theme, 'disabled-bottom-line-color');

            &:hover {
                border-block-end-color: var-get($_theme, 'disabled-bottom-line-color');
            }
        }

        &:hover {
            @include e(bundle) {
                background: inherit;
            }

            @include e(toggle-button) {
                cursor: default;
                color: var(--toggle-button-foreground-disabled);
                background: var(--toggle-button-background-disabled);
            }

            @include e(clear-button) {
                cursor: default;
                color: var-get($_theme, 'disabled-text-color');
                background: var-get($_theme, 'border-disabled-background');
            }
        }
    }
}

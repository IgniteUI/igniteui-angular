@use 'sass:map';
@use '../../base' as *;
@use '../../themes/schemas' as *;

////
/// @group themes
/// @access public
/// @author <a href="https://github.com/desig9stein" target="_blank">Marin Popov</a>
/// @author <a href="https://github.com/simeonoff" target="_blank">Simeon Simeonoff</a>
////

/// @param {Map} $schema [$light-schema] - The schema used as basis for styling the component.
/// @param {Color} $search-separator-border-color [null] - The combo search box separator color.
/// @param {Color} $empty-list-placeholder-color [null] - The combo placeholder text color.
/// @param {Color} $empty-list-background [null] - The combo list background color.
/// @param {Color} $toggle-button-background [null] - The combo toggle button background color.
/// @param {Color} $toggle-button-background-hover [null] - The combo toggle button background color on hover.
/// @param {Color} $toggle-button-background-focus [null] - The combo toggle button background color when the combo is focused.
/// @param {Color} $toggle-button-foreground [null] - The combo toggle button background color.
/// @param {Color} $toggle-button-foreground-hover [null] - The combo toggle button background color on hover.
/// @param {Color} $toggle-button-foreground-focus [null] - TThe combo toggle button background color when the combo is focused.
/// @param {Color} $clear-button-background [null] - The combo clear button background color.
/// @param {Color} $clear-button-background-hover [null] - The combo clear button background color on hover.
/// @param {Color} $clear-button-background-focus [null] - The combo clear button background color when the combo is focused.
/// @param {Color} $clear-button-foreground [null] - The combo toggle clear background color.
/// @param {Color} $clear-button-foreground-hover [null] - The combo clear button background color on hover.
/// @param {Color} $clear-button-foreground-focus [null] - TThe combo clear button background color when the combo is focused.
/// @requires $light-schema
/// @example scss Change the combo empty list background
///   $my-combo-theme: igx-checkbox-theme($empty-list-background);
///   // Pass the theme to the css-vars mixin
///   @include css-vars($my-combo-theme);
@function combo-theme(
    $schema: $light-schema,
    $search-separator-border-color: null,
    $empty-list-placeholder-color: null,
    $empty-list-background: null,
    $toggle-button-background: null,
    $toggle-button-background-hover: null,
    $toggle-button-background-focus: null,
    $toggle-button-foreground: null,
    $toggle-button-foreground-hover: null,
    $toggle-button-foreground-focus: null,
    $clear-button-background: null,
    $clear-button-background-hover: null,
    $clear-button-background-focus: null,
    $clear-button-foreground: null,
    $clear-button-foreground-hover: null,
    $clear-button-foreground-focus: null,
) {
    $name: 'igx-combo';
    $selector: 'igx-combo, igx-simple-combo';

    $combo-schema: ();

    @if map.has-key($schema, $name) {
        $combo-schema: map.get($schema, $name);
    } @else {
        $combo-schema: $schema;
    }

    $theme: digest-schema($combo-schema);

    @return extend($theme, (
        name: $name,
        selector: $selector,
        search-separator-border-color: $search-separator-border-color,
        empty-list-placeholder-color: $empty-list-placeholder-color,
        empty-list-background: $empty-list-background,
        toggle-button-background: $toggle-button-background,
        toggle-button-background-hover: $toggle-button-background-hover,
        toggle-button-background-focus: $toggle-button-background-focus,
        toggle-button-foreground: $toggle-button-foreground,
        toggle-button-foreground-hover: $toggle-button-foreground-hover,
        toggle-button-foreground-focus: $toggle-button-foreground-focus,
        clear-button-background: $clear-button-background,
        clear-button-background-hover: $clear-button-background-hover,
        clear-button-background-focus: $clear-button-background-focus,
        clear-button-foreground: $clear-button-foreground,
        clear-button-foreground-hover: $clear-button-foreground-hover,
        clear-button-foreground-focus: $clear-button-foreground-focus,
    ));
}

/// @param {Map} $theme - The theme used to style the component.
@mixin combo($theme) {
    @include css-vars($theme);

    $variant: map.get($theme, variant);

    %igx-combo {
        position: relative;
        display: block;
    }

    %igx-combo__checkbox {
        margin-inline-end: rem(8);
    }

    %igx-combo__drop-down {
        position: absolute;
        width: 100%;

        .igx-drop-down {
            width: 100%;
        }
    }

    %igx-combo__search {
        padding: rem(8px) rem(16px);
        margin: 0 !important;
        z-index: 26;
        border-bottom: rem(1px) dashed var-get($theme, 'search-separator-border-color');

        .igx-input-group__bundle {
            padding-block-start: 0;
            height: auto;
        }
    }

    %igx-combo__content {
        position: relative;
        overflow: hidden;

        &:focus {
            outline: transparent;
        }
    }

    %igx-combo__add {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        position: relative;
        padding: rem(16px);
        gap: rem(16px);
        background: var-get($theme, 'empty-list-background');
    }

    %igx-combo__add-item {
        height: auto !important;
        background: var-get($theme, 'empty-list-background') !important;
        justify-content: center !important;
    }

    %igx-combo__empty {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        color: var-get($theme, 'empty-list-placeholder-color');
        padding: 0 rem(24px);
        font-size: rem(13px);
    }

    %igx-combo__toggle-button {
        background: var-get($theme, 'toggle-button-background');
        color: var-get($theme, 'toggle-button-foreground') !important;

        &:hover {
            background: var-get($theme, 'toggle-button-background-hover');
            color: var-get($theme, 'toggle-button-foreground-hover') !important;
        }

        &:focus {
            background: var-get($theme, 'toggle-button-background-focus');
            color: var-get($theme, 'toggle-button-foreground-focus') !important;
        }
    }

    %igx-combo__clear-button {
        background: var-get($theme, 'clear-button-background');
        color: var-get($theme, 'clear-button-foreground');

        @if $variant == 'bootstrap' {
            border-inline-end: rem(1px) solid var(--border-color);
        }

        &:hover {
            background: var-get($theme, 'clear-button-background-hover');
            color: var-get($theme, 'clear-button-foreground-hover');
        }

        &:focus {
            background: var-get($theme, 'clear-button-background-focus');
            color: var-get($theme, 'clear-button-foreground-focus');
        }
    }
}
